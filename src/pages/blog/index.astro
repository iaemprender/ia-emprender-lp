---
import Layout from '../../layouts/Layout.astro';
// AÑADE CollectionEntry aquí para el tipado correcto
import { getCollection, type CollectionEntry } from 'astro:content'; 
import BlogImage from '../../assets/blog-placeholder-about.jpg'; 

// 1. Tipamos explícitamente la colección (esto resuelve el error 'slug' y 'any')
const allBlogPosts: CollectionEntry<'blog'>[] = await getCollection('blog');

// 2. Ordena los posts por fecha de publicación (más reciente primero)
const sortedPosts = allBlogPosts.sort((a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime());
---

<Layout title="Blog de IA Emprender Academy" hasTopBar={false} hasLegalFooter={false}>
    
    <section class="container mx-auto py-16 px-4 max-w-5xl">
        <header class="text-center mb-12">
            </header>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            
            {sortedPosts.map((post) => (
                <a href={`/blog/${post.slug}/`} class="block bg-white rounded-xl shadow-lg hover:shadow-xl transition duration-300 transform hover:scale-[1.02] overflow-hidden">
                    <img 
                        src={post.data.heroImage || BlogImage.src} 
                        alt={`Miniatura de ${post.data.title}`} 
                        class="w-full h-48 object-cover"
                    />
                    <div class="p-6 text-left">
                        <span class={`text-sm font-semibold uppercase tracking-wider ${post.data.tag === 'Estrategia' ? 'text-red-600' : 'text-gray-600'}`}>
                            {post.data.tag || 'General'}
                        </span>
                        </div>
                </a>
            ))}
            
        </div>
        
    </section>

</Layout>